version: 2

models:

  - name: stg_local_bike__products
    description: "List of the bikes sold by the company"
    columns:
      - name: product_id
        description: "Unique identify (Primary key) of the product"
        tests:
          - not_null
          - unique

      - name: product_name
        description: "Name of the product"
        tests:
          - not_null

      - name: brand_id
        description: "Secondary key to join the brands table. Id of the product's brand"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('stg_local_bike__brands')
                field: brand_id

      - name: category_id
        description: "Secondary key to join the categories table. Id of the product's category"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('stg_local_bike__categories')
                field: category_id

      - name: model_year
        description: "Year of production of the product"
        tests:
          - not_null
          - dbt_utils.expression_is_true:
                expression: ">= 2000"

      - name: product_unit_price
        description: "Unit price of the product"
        tests:
          - not_null
          - dbt_utils.expression_is_true:
                expression: "> 0"